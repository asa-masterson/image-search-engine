<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View images from internal api</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&display=swap" rel="stylesheet">
    <script>
        async function createImages() {
            try {
                console.log("Grabbing images...")
                document.getElementById('NewImages').innerHTML = "<h1>Grabbing images...</h1>"
                engine = document.getElementById("engine").value
                amount = document.getElementById("amount").value
                search = document.getElementById("searchBar").value
                query = engine + "///" + amount + "///" + search
                url="http://127.0.0.1:8080/" + query
                const response = await fetch(url);
                var images = await response.json();
                document.getElementById('NewImages').innerHTML = "<h1>You are viewing "+amount+" images of<br>"+search+"<br>on "+engine+"</h1>"
                console.log(images);

                for (var image of images) {
                    var img = document.createElement('img');
                    img.src = image;
                    img.height = 200
                    document.getElementById('NewImages').appendChild(img);
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            } catch(error) {
                document.getElementById('NewImages').innerHTML = "<h1>An error occurred while trying to fetch: <br>'"+error.message+"'</h1>"
            }

        }
    </script>
</head>
<body style="text-align: center; font-family: 'Bungee Spice', cursive;">

<input id="searchBar" onchange="createImages()" style="width: 50%" placeholder="What would you like to see?"></input>
<input type="number" value="5" id="amount" min="1" max="100">
<select id="engine">
    <option value="google">Google</option>
    <option value="bing">Bing</option>
    <option value="duckduckgo">DuckDuckGo</option>
    <option value="yahoo">Yahoo!</option>
  </select>
<p></p>
    
<div id="NewImages"></div>

</body>
</html>